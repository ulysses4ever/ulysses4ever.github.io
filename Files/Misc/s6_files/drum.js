function removeAfterReject(b,a){b.stopImmediatePropagation();$("#"+a).dialog("close")}(function(d){var s=5;var h=21;function r(){var v=0;for(var w in this.list){v++}return v}function g(x){var v=0;for(var w in this.list){if(x==w){return v}v++}return -1}function a(v){if(v>=0&&v<this.len()){var w=0;for(var x in this.list){if(w==v){return x}w++}}return null}function p(v){this.list=v;this.len=r;this.index=g;this.get=a}var k=new p({});window.initDrum=function(v){var w=d("#shadowWrap");w.height(getInsideWindowHeight()).show();d.ajaxSetup({cache:false});d.ajax({url:v.initDrumUrl,dataType:"json",success:function(y,x,z){d("#ButtonRemove").unbind("click");if(y){k=new p(y);if(k.len()){b(k.list,v);d("#orderServiceButton").css({display:"block"});d("#fullServiceInfoButton").css({display:"block"});d("#ButtonRemove").bind("click",v,u).removeClass("disable")}else{cleanEmptyButtons(v.textWrapperClass);w.hide()}}else{cleanEmptyButtons(v.textWrapperClass,true);w.hide()}},error:function(){d("div."+v.textWrapperClass).text("Ошибка при запросе к серверу. Приносим извинения");
w.hide()}})};function f(x){var v=d("#orderServiceButton");var w=k.list[x].orderUrl;v.unbind("click");v.bind("click",function(){var y=d("#checkServiceStatusUrl").val().replace("{id}",x);d.ajaxSetup({cache:false});var z=d("#shadowWrap");z.height(getInsideWindowHeight()).show();d.ajax({url:y,type:"POST",dataType:"json",success:function(A){z.hide();if(A.errorCode=="0"){window.location=w}else{AchtungDialog.show({title:"Предупреждение",subtitle:"Уважаемый пользователь Портала!",content:A.errorMessage,buttons:[{text:"Закрыть",callback:function(){AchtungDialog.hide()},params:{"class":"buttonClass"}}]})}},error:function(A){z.hide();AchtungDialog.show({title:"Предупреждение",subtitle:"Уважаемый пользователь Портала!",content:"По техническим причинам веб-сервис ведомства для обработки формы заявления временно недоступен. Попробуйте повторить попытку позже.",buttons:[{text:"Закрыть",callback:function(){AchtungDialog.hide()},params:{"class":"buttonClass"}}]})}})});d("#fullServiceInfoButton").attr("href",k.list[x].infoUrl)
}function m(z,y,w,D,E){var A=w.buttonHtml;var B=d(A);if(!y.buttonLabel){var x=y.label;var C=(x.length>h);if(x.length>(h*2+1)||(C&&c(x))){x=q(x);y.buttonLabel=x}else{if(C){y.buttonLabel=x}}}else{x=y.buttonLabel}if(x.length>h){d(B).addClass("TwoLine")}d(B).attr("id",z).addClass(w.buttonClass).find("span").html(x);if(D){d(B).addClass("active")}j(z,D);d(B).click(function(F){F.preventDefault();n(B,w.buttonClass)});var v="div."+w.buttonWrapperClass;if(E){d(v).prepend(B)}else{d(v).append(B)}return true}function j(B,y){var v=k.list[B];if(v&&v.descriptionText){if(y){if(v.descriptionText.status===2){f(B);d("#myServicesTitle").text(k.list[B].label);d("#textLk").html(v.descriptionText.textDefine);e()}else{setTimeout("readTextUrl('"+B+"', '"+y+"')",500)}d("#shadowWrap").hide()}return}else{v.descriptionText={status:1};var A=v.textUrl.indexOf("http")===0;var z=v.textUrl;if(A){var w=(v.textUrl).replace(/^(\w+:).*$/,"$1");var x=document.location.protocol;if(x!=w){z=x+(v.textUrl).substr(w.length)}}d.ajaxSetup({cache:false});
d.ajax({url:z,success:function(C){v.descriptionText.textDefine=C;v.descriptionText.status=2;if(y){f(B);d("#myServicesTitle").text(k.list[B].label);d("#textLk").html(v.descriptionText.textDefine);e()}d("#shadowWrap").hide()},error:function(){v.descriptionText.textDefine="Описание услуги не найдено";if(y){f(B);d("#myServicesTitle").text(k.list[B].label);d("#textLk").html(v.descriptionText.textDefine);e()}}})}}function n(y,v,x){if(x){d("#"+x).removeClass("active")}else{var w=d("a."+v+".active");d(w).removeClass("active")}d(y).addClass("active");j(d(y).attr("id"),true)}function b(z,y,D){d("#ButtonUp").removeClass("active").unbind("click",o);d("#ButtonDown").removeClass("active").unbind("click",t);var C=0;var E=y&&y.selectedService?y.selectedService:(D?D:0);var A=E?k.index(E):0;if(A==-1){A=0}else{if(A>=s){var x=A-s+1}}var G=x?s+x:s;var w=d("div."+y.textWrapperClass);if(w&&w.length){var v='<div id="textLk"  class='+y.textClass+"/>";d(w).append(v)}for(var B in z){if(x){x--;if(x===0){d("#ButtonUp").addClass("active").bind("click",y,o);
j(B,false)}C++;continue}var F=(C===A);if(C<G){m(B,z[B],y,F)}else{d("#ButtonDown").addClass("active").bind("click",y,t);j(B,false);return}C++}}function o(w){w.preventDefault();var D="a."+w.data.buttonClass;var B=d(D+":last");var A=d(D+":first").attr("id");var x=k.index(A);var z=(x===0)?null:k.get(x-1);if(z){var C=d(B).hasClass("active");m(z,k.list[z],w.data,false,true);var y=d(B).attr("id");d(B).remove();if(C){n(d(D+":last"),w.data.buttonClass,y)}if(x===1){d("#ButtonUp").removeClass("active").unbind("click",o)}else{if(x>1){var v=k.get(x-2);if(v){j(v,false)}}}if(k.index(y)==k.len()-1){d("#ButtonDown").addClass("active").bind("click",w.data,t)}}}function t(v){v.preventDefault();var E="a."+v.data.buttonClass;var x=d(E+":first");var A=d(E+":last").attr("id");var z=k.index(A);var y=k.len()-1;var D=(z===y)?null:k.get(z+1);if(D){var C=d(x).hasClass("active");m(D,k.list[D],v.data);var B=d(x).attr("id");d(x).remove();if(C){n(d(E+":first"),v.data.buttonClass,B)}if(k.index(B)===0){d("#ButtonUp").addClass("active").bind("click",v.data,o)
}if(z===y-1){d("#ButtonDown").removeClass("active").unbind("click",t)}else{if(z<y-1){var w=k.get(z+2);if(w){j(w,false)}}}}}window.removeAfterConfirm=function(x){x.preventDefault();x.stopImmediatePropagation();var v=d("#confirmYes").data("obj");d("#"+v.dialogId).dialog("close");var z=d("a."+v.buttonClass+".active");var G=d(z).attr("id");if(z.length&&v.excludeServiceUrl&&G){var F=k.index(d("a."+v.buttonClass+":first").attr("id"));var E=k.index(d("a."+v.buttonClass+":last").attr("id"));var C=k.index(G);d("#ButtonRemove").unbind("click").addClass("disable");var w=d("#shadowWrap");w.height(getInsideWindowHeight()).show();var D=v.excludeServiceUrl.indexOf("http")===0;var A=v.excludeServiceUrl;if(D){var B=(v.excludeServiceUrl).replace(/^(\w+:).*$/,"$1");var y=document.location.protocol;if(y!=B){A=y+(v.excludeServiceUrl).substr(B.length)}}d.ajaxSetup({cache:false});d.ajax({url:A,data:{serviceCode:G},success:function(H){if(H.errorCode){d("#ButtonRemove").bind("click",v,u).removeClass("disable");
w.hide();retErrorProccess("Удаление услуги","Произошла ошибка во время выполнения запроса.<br/>Попробуйте выполнить операцию позже");return false}d("div."+v.buttonWrapperClass).empty();d("div."+v.textWrapperClass).empty();k=new p(H);if(k.len()){C=(F==C)?F+1:((E==C)?E-1:C);var I=k.get(C);b(k.list,v,I);d("#orderServiceButton").css({display:"block"});d("#fullServiceInfoButton").css({display:"block"});d("#ButtonRemove").bind("click",v,u).removeClass("disable")}else{cleanEmptyButtons(v.textWrapperClass);w.hide()}return true},error:function(){w.hide();d("#ButtonRemove").bind("click",x.data,u).removeClass("disable");retErrorProccess("Удаление услуги","Произошла ошибка во время выполнения запроса.<br/>Попробуйте выполнить операцию позже");return false}})}};function u(v){v.preventDefault();d("#confirmYes").data("obj",v.data);if(v.data&&v.data.dialogId){d("#"+v.data.dialogId).dialog("open")}}window.callAddService=function(w,D,C,A){w.preventDefault();var v=d("#shadowWrap");v.height(d(document).height()).show();
var y=C;var B=C.indexOf("http")===0;if(B){var z=C.replace(/^(\w+:).*$/,"$1");var x=document.location.protocol;if(x!=z){y=x+C.substr(z.length)}}d.ajaxSetup({cache:false});d.ajax({url:y,data:{serviceCode:D},success:function(F){if(F.errorCode&&F.errorCode!="0"){v.hide();retErrorProccess("Добавление услуги","Произошла ошибка во время попытки добавления услуги.");return false}var E=A+"?selectedService="+D;document.location.replace(E);return true},error:function(){v.hide();retErrorProccess("Добавление услуги","Произошла ошибка во время попытки добавления услуги.");return false}})};window.callBeforeRemoveServiceFromOrders=function(w,v){w.preventDefault();d("#"+v).dialog("open")};window.retErrorProccess=function(y,x,w){var v=d(".popupWrap");d(".title",v).html(y);if(w){d(".subtitle",v).text("")}else{d(".subtitle",v).text("Приносим свои извинения")}d(".popupText",v).html(x);d(".popupShadow").height(d(document.body).height()).show();v.show()};d("#deleteNo").bind("click",function(){d("#excludeDialog").dialog("close")
});window.callRemoveService=function(w,C,B,D){w.preventDefault();w.stopImmediatePropagation();d("#"+D).dialog("close");var v=d("#shadowWrap");v.height(d(document).height()).show();var y=B;var A=B.indexOf("http")===0;if(A){var z=B.replace(/^(\w+:).*$/,"$1");var x=document.location.protocol;if(x!=z){y=x+B.substr(z.length)}}d.ajaxSetup({cache:false});d.ajax({url:y,data:{serviceCode:C,resultIsStatus:"true"},success:function(E){if(E.errorCode&&E.errorCode!="0"){v.hide();retErrorProccess("Удаление услуги","Произошла ошибка во время удаления услуги.");return false}d("#addToFavorites").css({display:"block"});d("#removeFromFavorites").css({display:"none"});v.hide();return true},error:function(){v.hide();retErrorProccess("Удаление услуги","Произошла ошибка во время удаления услуги.");return false}})};window.cleanEmptyButtons=function(v,w){d("#myServicesTitle").text("");var x="div."+v+":last";if(w){d(x).text("Сервис временно недоступен. Приносим извинения")}else{d(x).append("<p>Раздел предназначен для быстрого доступа к часто заказываемым услугам. Нажмите «Добавить», выберите услугу, и на барабане справа появится кнопка с её наименованием.</p>")
}e();d("#orderServiceButton").css({display:"none"});d("#fullServiceInfoButton").css({display:"none"});d("#ButtonRemove").addClass("disable")};function i(v){if(d.browser.mozilla){console.time(v)}}function l(v){if(d.browser.mozilla){console.timeEnd(v)}}function e(){var v=223-d("#myServicesTitle").height();d("#myServicesScroll").height(v).jScrollPane({showArrows:true,scrollbarWidth:34,dragMinHeight:95,dragMaxHeight:95})}function q(A){var x=2;var D=true;var v="";for(var B=0;B<x;B++){var E=(D)?A.substring(0,h-1):A.substring(A.length-(h-1),A.length);var w=(D)?E.substr(-1,1):E.substr(0,1);if(w!=" "){var z=false;var y=E.indexOf(" ",0);if(y!=-1){z=true;if(D){var C=y;while(C!=-1){y=C;C=E.indexOf(" ",C+1)}}}if(z){E=(D)?E.substring(0,y):E.substring(y,h-1)}}if(D){D=false;v+=(E+"...<br/>")}else{v+=("..."+E)}}return v}function c(w){var z=w.indexOf(" ",0);if(z==-1||(z>h)){return true}if((w.length-z-1)>h){var y=w.substring(z+1);var x=y.indexOf(" ",0);var v=z+1+x;if(x!=-1&&(v<=h)&&((w.length-v-1)<=h)){return false
}return true}return false}})(jQuery);