function closeDialogBox(d,c,a,b){if($("#"+d).dialog("isOpen")){$("#"+d).dialog("close");if(c){window.location=c}if(a&&b){$(a).trigger(b)}}}(function(b){var c='Если Вы не получили код подтверждения, то нажмите "ВЫСЛАТЬ КОД" для его повторной отправки.<br/> Введите код подтверждения и нажмите "ПОДТВЕРДИТЬ".<br/>Если Вы хотите вернуться к старому значению контактных данных, нажмите "ОТМЕНИТЬ".';window.callDialogBox=function(e,g){e.preventDefault();e=(e)?e:((window.event)?e:null);if(e){if(b.browser.msie){e.target=e.srcElement}}var j=e.target.id;var i=b("#"+g.id);i.unbind("keypress");b("#confirmSend").unbind("click");b("#confirmYes").unbind("click");b("#confirmNo").unbind("click");var l;var m;b("#"+g.errorId).text("");var h=b(e.target).attr("id");if(h=="confirmMobile"){l="MBT";var f=b("#mobileTel").val();var d=b("#mobileTelOld").val();m="На Ваш номер "+f+" была выслана СМС с кодом подтверждения.<br/>";m+=c;m+="<br/><br/>Номер мобильного телефона "+d+" меняется на номер "+f}else{if(h=="confirmEmail"){l="EML";
var f=b("#email").val();var d=b("#emailOld").val();m="На Вашу электронную почту "+f+" было выслано письмо с кодом подтверждения.<br/>";m+=c;m+="<br/><br/>Электронная почта "+d+" меняется на электронную почту "+f}else{alert("unknown id: "+h)}}i.val("");var n=function(o){if(o.which===0||o.which===8||o.which===13||o.which===9||o.which===118){b("#"+g.errorId).text("");return true}else{if(o.which>=48&&o.which<=57){return true}else{b("#"+g.errorId).text("Код подтверждения должен содержать только цифры");return false}}};var k=function(p){var q=b("#confirmYes");var o=q.hasClass("disable");if(p&&!o){q.addClass("disable")}else{if(!p&&o){q.removeClass("disable")}}};if(b.browser.msie){i.bind("keydown",function(o){o.target=o.srcElement;if(o.which===8){b("#"+g.errorId).text("");if(o.target.value.length===7){k(false);return}k(true)}})}i.bind("keypress",function(o){var p=n(o);if(b.browser.msie){o.target=o.srcElement}if(p&&((o.target.value.length===5&&o.which>=48&&o.which<=57)||(o.target.value.length===6))){k(false)
}else{k(true)}if(o.target.value.length>=6){if(o.target.value.length>6||(o.target.value.length===6&&o.which!=0&&o.which!=8&&String.fromCharCode(o.which))){b("#"+g.errorId).text("Код подтверждения должен содержать 6 цифр");return false}else{if(p){b("#"+g.errorId).text("");return true}}}else{return true}});i.bind("paste",function(){return false});b("#"+g.errorId).val("");b("#confirmSend").bind("click",{id:g.id,errorId:g.errorId,action:"send",urlRequest:g.urlSend,dialogId:g.dialogId,type:l},a);b("#confirmYes").bind("click",{id:g.id,errorId:g.errorId,action:"confirm",urlRequest:g.urlConfirm,dialogId:g.dialogId,type:l},a);b("#confirmNo").bind("click",{id:g.id,errorId:g.errorId,action:"reject",urlRequest:g.urlReject,dialogId:g.dialogId,type:l,urlParent:g.urlParent,selectorClose:g.selector,actionClose:g.action},a);b("#confirmSend,#confirmNo").removeClass("disable");b("#confirmYes").addClass("disable");b("#"+g.messageId).html(m);b("#"+g.dialogId).dialog("open")};function a(e){e.preventDefault();
if(!e.data){return}var d=b("#"+e.data.id).val();var f={contactType:e.data.type};if(e.data.action=="confirm"){if(!d){b("#"+e.data.errorId).text("Пожалуйста, введите код подтверждения");return}f.confirmationCode=d}b("#"+e.data.errorId).text("Выполняется запрос ...");b.ajaxSetup({cache:false});b.ajax({url:e.data.urlRequest,data:f,type:"POST",dataType:"json",success:function(g){if(g){b("#"+e.data.errorId).text(g.message);if(g.success){if(e.data.action=="send"){b("#confirmSend").unbind("click").addClass("disable");return}else{if(e.data.action=="reject"){closeDialogBox(e.data.dialogId,e.data.urlParent,e.data.selectorClose,e.data.actionClose);return}}b("#confirmSend, #confirmYes, #confirmNo").unbind("click").addClass("disable")}}else{b("#"+e.data.errorId).text("Произошла ошибка при выполнении запроса")}},error:function(){b("#"+e.data.errorId).text("Произошла ошибка при выполнении запроса")}})}})(jQuery);